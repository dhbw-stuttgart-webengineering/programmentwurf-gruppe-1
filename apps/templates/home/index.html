{% extends "layouts/base-fullscreen.html" %} 
{% block title %} Home {%endblock title %} 
{% block content %}

<main class="grid-container">
  <div class="grades">
    {% if request.user.is_authenticated %}
    <p>Willkommen, {{ request.user.name }}!</p>
    {% else %}
    <p>Du bist nicht eingeloggt!</p>
    {% endif %} 
    {% if perms.is_superuser %}
    <p>Du bist ein Admin.</p>
    {% else %}
    <p>Du bist kein Admin.</p>
    {% endif %}

    <h2>Eigene Noten</h2>
    <table>
      <thead>
        <tr>
          <th>Kurs</th>
          <th>Note</th>
        </tr>
      </thead>
      <tbody>
        {% for grade in own_grades %}
        <tr>
          <td>{{ grade.course }}</td>
          <td>{{ grade.grade }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <a href="{% url 'logout' %}?csrfmiddlewaretoken={{ csrf_token }}">Logout</a>
  </div>

  <div class="chart-box">
    <canvas id="comparechart"></canvas>
  </div>

  <div class="chart-box">
    <canvas id="misschart"></canvas>
  </div>
</main>

<style>
  .grid-container {
    display: grid;
    grid-template-columns: 1fr 1fr; /* Zwei Spalten */
    grid-template-rows: 1fr 1fr; /* Automatische Höhe */
    gap: 20px; /* Abstand zwischen den Spalten */
  }

  .grades, .chart-box {
    border: 2px solid #ccc;
    border-radius: 10px;
    padding: 10px;
    max-width: 500px;
    width: 100%; /* Jede Box nimmt die gesamte verfügbare Breite */
  }

  .grades {
    grid-column: 1 / 2; /* Position in erster Spalte */
    grid-row: 1 / 3; /* Position in erster Zeile */
  }

  .chart-box {
    grid-column: 2 / 3; /* Position in zweiter Spalte */
    margin-bottom: 20px; /* Abstand zwischen den Diagrammen */
    display: flex; /* Elemente als Flexbox behandeln */
    justify-content: center; /* Inhalt horizontal zentrieren */
    align-items: center; /* Inhalt vertikal zentrieren */
  }
  #comparechart{
    grid-row: 1 / 2; /* Position in erster Zeile */
  }

  #misschart {
    grid-row: 2 / 3; /* Position in zweiter Zeile */
  }
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var ctx = document.getElementById('comparechart').getContext('2d');
    var myChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Kurs A', 'Kurs B', 'Kurs C', 'Kurs D'],
        datasets: [{
          label: 'Durchschnittsnoten',
          data: [2.4, 1.9, 3.7, 2.1],
          backgroundColor: generateRandomColors(4),
          borderColor: 'rgba(75, 192, 192, 1)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: false, // Beginnt nicht bei 0
            min: 1, // Mindestwert für y-Achse
            max: 6, // Maximalwert für y-Achse
          }
        },
        plugins: {
          legend: {
            display: false
          },
          title: {
            display: true,
            text: 'Kursvergleich'
          }
        }
      }
    });

    function generateRandomColors(numColors) {
      var colors = [];
      for (let i = 0; i < numColors; i++) {
        var randomColor = 'rgba(' + Math.floor(Math.random() * 256) + ',' + Math.floor(Math.random() * 256) + ',' + Math.floor(Math.random() * 256) + ', 0.5)';
        colors.push(randomColor);
      }
      return colors;
    }
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
	document.addEventListener("DOMContentLoaded", function () {
	  var ctx = document.getElementById("misschart").getContext("2d");
	  var myChart = new Chart(ctx, {
		type: "doughnut",
		data: {
		  labels: ["Durchgefallen", "Bestanden"],
		  datasets: [
			{
			  data: [0.6, 0.4],
			  backgroundColor: [
				"rgba(255, 99, 132, 0.5)",
				"rgba(75, 192, 192, 0.5)",
			  ],
			  borderColor: ["rgba(255,99,132,1)", "rgba(75, 192, 192, 1)"],
			  borderWidth: 1,
			},
		  ],
		},
		options: {
		  responsive: true,
		  plugins: {
			legend: {
			  position: "top",
			},
			title: {
			  display: true,
			  text: "Prüfungsergebnisse",
			},
		  },
		},
	  });
	});
  </script>

{% endblock content %}
