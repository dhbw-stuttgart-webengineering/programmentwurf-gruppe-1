{% extends "layouts/base-fullscreen.html" %} 
{% block title %} Home {%endblock title %} 
{% block content %}

<main>
  {% if request.user.is_authenticated %}
  <p>Willkommen, {{ request.user.name }}!</p>
  {% else %}
  <p>Du bist nicht eingeloggt!</p>
  {% endif %} {% if perms.is_superuser %}
  <p>Du bist ein Admin.</p>
  {% else %}
  <p>Du bist kein Admin.</p>
  {% endif %}

  <div class="chart-container">
    <div class="chart-box">
      <canvas id="comparechart"></canvas>
    </div>
    <div class="chart-box">
      <canvas id="misschart"></canvas>
    </div>
  </div>

  <a href="{% url 'logout' %}?csrfmiddlewaretoken={{ csrf_token }}">Logout</a>
</main>

<style>
	.chart-container {
	  display: flex;
	  justify-content: center;
	  align-items: center;
	  height: 100vh;
	  gap: 20px; /* Abstand zwischen den Boxen */
	}
  
	.chart-box {
	  border: 2px solid #ccc;
	  border-radius: 10px;
	  padding: 10px;
	  max-width: 500px;
	  width: 100%; /* Jede Box nimmt die gesamte verfügbare Breite */
	}
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var ctx = document.getElementById('comparechart').getContext('2d');
    var myChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: [{% for course in courses %}'{{ course.name }}',{% endfor %}],
        datasets: [{
          label: 'Durchschnittspunktzahl',
          data: [{% for course in courses %}{{ course.average_points }},{% endfor %}],
          backgroundColor: 'rgba(75, 192, 192, 0.5)',
          borderColor: 'rgba(75, 192, 192, 1)',
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
            max: 100
          }
        },
        plugins: {
          legend: {
            display: false
          },
          title: {
            display: true,
            text: 'Kursvergleich'
          }
        }
      }
    });
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
	document.addEventListener("DOMContentLoaded", function () {
	  var ctx = document.getElementById("misschart").getContext("2d");
	  var myChart = new Chart(ctx, {
		type: "doughnut",
		data: {
		  labels: ["Durchgefallen", "Bestanden"],
		  datasets: [
			{
			  data: [0.6, 0.4],
			  backgroundColor: [
				"rgba(255, 99, 132, 0.5)",
				"rgba(75, 192, 192, 0.5)",
			  ],
			  borderColor: ["rgba(255,99,132,1)", "rgba(75, 192, 192, 1)"],
			  borderWidth: 1,
			},
		  ],
		},
		options: {
		  responsive: true,
		  plugins: {
			legend: {
			  position: "top",
			},
			title: {
			  display: true,
			  text: "Prüfungsergebnisse",
			},
		  },
		},
	  });
	});
  </script>

{% endblock content %}
